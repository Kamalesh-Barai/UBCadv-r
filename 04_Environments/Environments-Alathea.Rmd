---
title: "Environments"
author: "Alathea"
date: '2014-07-21'
output: 
  html_document:
    keep_md: yes
    toc: yes
---

```{r libraries, echo = FALSE, message = FALSE}
library(pryr)
```

***

## Exercises

### List three ways in which an environment differs from a list.

* The environment has a parent
* Objects in an environment have no order
* Every object in an environment has to have a unique name

### If you don’t supply an explicit environment, where do `ls()` and `rm()` look? Where does `<-` make bindings?

They look in the current environment (usually `globalenv()`) and that is also where `<-` makes bindings.  Within a functions, the bindings are made in the function's environment.

### Using `parent.env()` and a loop (or a recursive function), verify that the ancestors of `globalenv()` include `baseenv()` and `emptyenv()`. Use the same basic idea to implement your own version of `search()`.

```{r ancestors, message = FALSE}
ancestors <- function(environ = globalenv())
{
  p <- parent.env(environ)
  print(environmentName(p))
  
  if(identical(p, emptyenv())) return(invisible())
  else ancestors(p)
}

ancestors()
```

***

## Reading Notes

### Quiz

#### List three ways that an environment is different to a list.

from Hadley:

> * Every object in an environment has a unique name.
> * The objects in an environment are not ordered (i.e. it doesn’t make sense to ask what the first object in an environment is).
> * An environment has a parent.
> * Environments have reference semantics.

#### What is the parent of the global environment? What is the only environment that doesn’t have a parent?

The parent of the global environment is the package that was attached last.  The **empty** environment (`emptyenv`) has no parent.

#### What is the enclosing environment of a function? Why is it important?

#### How do you determine the environment from which a function was called?

`parent.frame()`

#### How are `<-` and `<<-` different?

`<-` sets a value in the current environment. `<<-` sets the value in all environments (i think)

### Environment basics

Variables can point to objects that are equivalent but stored in different places in the environment.  This could be a cause of reduced performance if they are pointing to two different giant objects.

Objects that have lost their name are automatically deleted by the garbage collector.

Use `search()` to get all the parents of the global environment.  Use `ls()` to show all of the bindings in the current environment or a selected environment. Use `ls.str()` to get the structure of the environment.

```{r search, message = FALSE}
search()
ls()
ls(baseenv())
ls.str()
```

Use `rm()` to remove a binding from the environment.

```{r exists, message = FALSE}
a <- new.env()
y <- 11
exists("y", envir = a)
a$y
exists("x", envir = a, inherits = FALSE)
```

***

## Discussion Notes
